<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>CineGenesis: The Gold Master</title>
    
    <!-- PWA MANIFEST -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkNpbmVHZW5lc2lzIE9TIiwKICAic2hvcnRfbmFtZSI6ICJDaW5lR2VuZXNpcyIsCiAgInN0YXJ0X3VybCI6ICIvIiwKICAiZGlzcGxheSI6ICJzdGFuZGFsb25lIiwKICAiYmFja2dyb3VuZF9jb2xvciI6ICIjMDAwMDAwIiwKICAidGhlbWVfY29sb3IiOiAiIzAwMDAwMCJ9">
    
    <!-- CORE LIBRARIES -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- FIREBASE SDK (Iron Spine Modular Bridge) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, updateDoc, increment } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        
        // ===============================================================
        //  YOUR KEYS ARE PRE-LOADED BELOW
        // ===============================================================
        const firebaseConfig = {
            apiKey: "AIzaSyAhbTjjNsL32-_ElgZR1V0XuMWtRrlnNVM",
            authDomain: "cinegenesis-os.firebaseapp.com",
            projectId: "cinegenesis-os",
            storageBucket: "cinegenesis-os.firebasestorage.app",
            messagingSenderId: "441370974988",
            appId: "1:441370974988:web:a2453282a4344c201e8729"
        };
        // ===============================================================

        try {
            // INITIALIZE FIREBASE (SINGLE INSTANCE)
            const app = initializeApp(firebaseConfig);
            window.auth = getAuth(app);
            window.db = getFirestore(app);
            window.googleProvider = new GoogleAuthProvider();
            
            // BRIDGE FUNCTIONS
            window.fbSignIn = signInWithPopup;
            window.fbSignOut = signOut;
            window.fbOnAuth = onAuthStateChanged;
            
            console.log("OS: Iron Spine Secure.");
        } catch (e) {
            console.error("OS: Connection Failure.", e);
        }
    </script>

    <!-- FONTS -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;900&family=Playfair+Display:ital,wght@0,400;0,700;0,900;1,400&family=JetBrains+Mono:wght@700;800&display=swap" rel="stylesheet">
    
    <style>
        /* THE VOID (PURE BLACK START) */
        body { 
            background-color: #000000; 
            color: #E0E7FF; 
            height: 100vh; 
            overflow: hidden; 
            margin: 0; 
            font-family: 'Inter', sans-serif; 
            -webkit-font-smoothing: antialiased;
        }
        
        /* THE ATMOSPHERE (ROYAL BLUE) - HIDDEN AT START */
        .atmosphere {
            position: fixed; inset: 0; pointer-events: none;
            background: radial-gradient(circle at 50% 0%, #1e1b4b 0%, #050510 80%);
            opacity: 0; transition: opacity 3s ease; z-index: 0;
        }
        .atmosphere-active { opacity: 1; }

        /* GLASS ENGINE */
        .glass-hud { background: rgba(8, 8, 18, 0.95); backdrop-filter: blur(20px); border-left: 1px solid rgba(255, 255, 255, 0.1); }
        .glass-panel { background: rgba(15, 15, 35, 0.4); backdrop-filter: blur(30px); border: 1px solid rgba(255, 255, 255, 0.08); box-shadow: 0 20px 60px -10px rgba(0,0,0,0.8); }

        /* KINETIC VIEWPORT */
        .kinetic-viewport {
            background-color: #000;
            position: relative;
            z-index: 10;
        }
        .kinetic-loop { position: absolute; inset: 0; transition: opacity 0.2s ease; mix-blend-mode: screen; opacity: 0; }
        .kinetic-active { opacity: 1; animation: flash 0.15s infinite; }
        @keyframes flash { 0% { filter: brightness(1); } 50% { filter: brightness(1.6); } 100% { filter: brightness(1); } }

        /* TYPOGRAPHY */
        .huge-mapping { font-weight: 900; letter-spacing: -0.05em; line-height: 0.9; }
        .season-banner {
            background: linear-gradient(90deg, #D4AF37 0%, #FDE047 50%, #D4AF37 100%);
            background-size: 200% auto; animation: shine 3s linear infinite; -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        @keyframes shine { to { background-position: 200% center; } }
        
        /* SYNC BUTTON */
        .sync-highlight { box-shadow: 0 0 50px rgba(255, 255, 255, 0.1), inset 0 0 20px rgba(255, 255, 255, 0.1); }
        .sync-active {
            box-shadow: 0 0 150px rgba(255, 255, 255, 0.6), inset 0 0 50px rgba(255, 255, 255, 0.4);
            border-color: #FFF !important;
            transform: scale(1.1);
        }

        /* ORACLE SCANNER */
        .oracle-scanner {
            background: linear-gradient(180deg, rgba(56, 189, 248, 0) 0%, rgba(56, 189, 248, 0.3) 50%, rgba(56, 189, 248, 0) 100%);
            height: 2px; width: 100%; position: absolute; top: 0;
            animation: scanDown 2.5s ease-in-out infinite;
        }
        @keyframes scanDown { 0% { top: 0%; opacity: 0; } 50% { opacity: 1; } 100% { top: 100%; opacity: 0; } }

        /* GENESIS STREAM */
        .genesis-stream-container {
            position: absolute; top: 0; bottom: 0; right: 0; width: 350px;
            overflow: hidden; pointer-events: none; opacity: 0.3;
            mask-image: linear-gradient(to bottom, transparent, black 10%, black 90%, transparent);
            z-index: 1;
        }
        .genesis-content { animation: scrollUp 60s linear infinite; }
        @keyframes scrollUp { from { transform: translateY(0); } to { transform: translateY(-50%); } }

        /* BIO PULSE */
        .bio-pulse { animation: heartbeat 3s infinite ease-in-out; }
        @keyframes heartbeat { 
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(212, 175, 55, 0.1); border-color: rgba(212, 175, 55, 0.3); } 
            50% { transform: scale(1.05); box-shadow: 0 0 30px 5px rgba(212, 175, 55, 0.2); border-color: rgba(212, 175, 55, 0.8); } 
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(212, 175, 55, 0.1); border-color: rgba(212, 175, 55, 0.3); } 
        }

        /* ICONS & THEME */
        .text-azure { color: #38bdf8; }
        .btn-primary { 
            background: linear-gradient(135deg, #e0e7ff 0%, #cbd5e1 100%); 
            color: #0f172a; 
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1); 
        }
        .btn-primary:hover { transform: scale(1.03); box-shadow: 0 0 40px rgba(56, 189, 248, 0.4); }

        .btn-ignite { background: radial-gradient(circle at center, #FFF, #E5E5E5); box-shadow: 0 0 30px rgba(255, 255, 255, 0.1); transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
        .btn-ignite:hover { transform: scale(1.02); box-shadow: 0 0 50px rgba(212, 175, 55, 0.5); }

        .filter-noir { filter: grayscale(100%) contrast(120%); }
        .filter-neon { filter: contrast(110%) saturate(150%) hue-rotate(-10deg); }
        .xray-active { opacity: 0.3 !important; filter: grayscale(100%) brightness(50%) sepia(100%) hue-rotate(50deg) saturate(200%) !important; }
        .xray-grid { background-image: linear-gradient(rgba(56, 189, 248, 0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(56, 189, 248, 0.1) 1px, transparent 1px); background-size: 40px 40px; perspective: 1000px; transform: rotateX(60deg) translateY(-100px) scale(2); opacity: 0; transition: opacity 0.5s ease; }
        .xray-visible { opacity: 1; animation: gridScroll 10s linear infinite; }
        @keyframes gridScroll { from { background-position: 0 0; } to { background-position: 0 40px; } }
        .light-orb { width: 40px; height: 40px; background: radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(212, 175, 55, 0.5) 50%, transparent 70%); border-radius: 50%; position: absolute; cursor: grab; filter: blur(5px); mix-blend-mode: screen; z-index: 50; }
        .light-orb:active { cursor: grabbing; transform: scale(1.2); }

        ::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONS (FIXED) ---
        const Icon = ({ name, size = 16, className = "" }) => {
            const s = size; const c = `stroke-current ${className}`; const p = { strokeWidth: 3, fill: "none", strokeLinecap: "round", strokeLinejoin: "round" };
            if (name === 'lock') return <svg width={s} height={s} viewBox="0 0 24 24" {...p} className={c}><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>;
            if (name === 'zap') return <svg width={s} height={s} viewBox="0 0 24 24" {...p} className={c}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>;
            if (name === 'cpu') return <svg width={s} height={s} viewBox="0 0 24 24" {...p} className={c}><rect x="4" y="4" width="16" height="16" rx="2" ry="2"/><rect x="9" y="9" width="6" height="6"/><line x1="9" y1="1" x2="9" y2="4"/><line x1="15" y1="1" x2="15" y2="4"/><line x1="20" y1="9" x2="23" y2="9"/><line x1="1" y1="9" x2="4" y2="9"/></svg>;
            if (name === 'activity') return <svg width={s} height={s} viewBox="0 0 24 24" {...p} className={c}><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>;
            if (name === 'login') return <svg width={s} height={s} viewBox="0 0 24 24" {...p} className={c}><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/><polyline points="10 17 15 12 10 7"/><line x1="15" y1="12" x2="3" y2="12"/></svg>;
            if (name === 'eye') return <svg width={s} height={s} viewBox="0 0 24 24" {...p} className={c}><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>;
            if (name === 'heart') return <svg width={s} height={s} viewBox="0 0 24 24" {...p} className={c}><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>;
            if (name === 'briefcase') return <svg width={s} height={s} viewBox="0 0 24 24" {...p} className={c}><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>;
            if (name === 'sparkles') return <svg width={s} height={s} viewBox="0 0 24 24" {...p} className={c}><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.2-1.2L12 3Z"/></svg>;
            if (name === 'network') return <svg width={s} height={s} viewBox="0 0 24 24" {...p} className={c}><rect x="16" y="16" width="6" height="6" rx="1"/><rect x="2" y="16" width="6" height="6" rx="1"/><rect x="9" y="2" width="6" height="6" rx="1"/><path d="M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3"/><path d="M12 12V8"/></svg>;
            if (name === 'fastforward') return <svg width={s} height={s} viewBox="0 0 24 24" {...p} className={c}><polygon points="13 19 22 12 13 5 13 19"/><polygon points="2 19 11 12 2 5 2 19"/></svg>;
            if (name === 'logout') return <svg width={s} height={s} viewBox="0 0 24 24" {...p} className={c}><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4M16 17l5-5-5-5M21 12H9"/></svg>;
            if (name === 'grid') return <svg width={s} height={s} viewBox="0 0 24 24" {...p} className={c}><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>;
            return null;
        };

        // --- SOUND ENGINE ---
        const SoundEngine = {
            ctx: null,
            init: function() { if (!this.ctx) this.ctx = new (window.AudioContext || window.webkitAudioContext)(); },
            playTone: function(freq, type, duration, vol = 0.1) {
                this.init(); const osc = this.ctx.createOscillator(); const gain = this.ctx.createGain();
                osc.type = type; osc.frequency.setValueAtTime(freq, this.ctx.currentTime);
                gain.gain.setValueAtTime(vol, this.ctx.currentTime); gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + duration);
                osc.connect(gain); gain.connect(this.ctx.destination);
                osc.start(); osc.stop(this.ctx.currentTime + duration);
            },
            playClick: function() { this.playTone(800, 'square', 0.05, 0.05); },
            playStrobe: function() { this.playTone(150, 'sawtooth', 0.05, 0.1); },
            playOracle: function() { this.playTone(400, 'triangle', 0.2, 0.05); },
            playXray: function() { this.playTone(2000, 'sine', 0.3, 0.1); },
            playSuccess: function() { this.playTone(600, 'sine', 0.1, 0.1); setTimeout(() => this.playTone(900, 'sine', 0.3, 0.1), 100); },
            playIgnite: function() {
                this.init();
                const osc = this.ctx.createOscillator(); const gain = this.ctx.createGain();
                osc.frequency.setValueAtTime(100, this.ctx.currentTime); osc.frequency.exponentialRampToValueAtTime(800, this.ctx.currentTime + 1.5);
                gain.gain.setValueAtTime(0.1, this.ctx.currentTime); gain.gain.linearRampToValueAtTime(0, this.ctx.currentTime + 1.5);
                osc.connect(gain); gain.connect(this.ctx.destination);
                osc.start(); osc.stop(this.ctx.currentTime + 1.5);
            }
        };

        // --- GENESIS STREAM DATA ---
        const GENESIS_LOGS = [
            { ver: "v35.0", date: "NOW", event: "Gold Master. Keys Verified." },
            { ver: "v34.1", date: "YESTERDAY", event: "Double Init Fix. Forced Real Mode." },
            { ver: "v30.0", date: "YESTERDAY", event: "Absolute Master. Visual Intelligence Restored." },
            { ver: "v24.0", date: "DEC 25", event: "Complete Vision. Soul Algorithm Active." },
            { ver: "v21.0", date: "DEC 24", event: "Neural Sync Calibration Deployed." },
            { ver: "v18.0", date: "DEC 22", event: "Iron Spine Identity Protocol Secured." },
            { ver: "v16.0", date: "DEC 20", event: "Holo-Deck & X-Ray Vision Integrated." },
            { ver: "v14.0", date: "DEC 18", event: "Fractal Zoom Technology Online." },
            { ver: "v10.0", date: "DEC 12", event: "Nexus Economy & Genealogy Tree Established." },
            { ver: "v08.0", date: "DEC 08", event: "HyperLoop Financial Core." },
            { ver: "v01.0", date: "NOV 01", event: "Project CineGenesis Initiated." }
        ];

        // --- COMPONENTS ---

        // 1. GENESIS STREAM
        const GenesisStream = () => (
            <div className="genesis-stream-container hidden md:block">
                <div className="genesis-content space-y-6 px-6">
                    {[...GENESIS_LOGS, ...GENESIS_LOGS].map((log, i) => (
                        <div key={i} className="opacity-60 hover:opacity-100 transition-opacity">
                            <div className="flex justify-between text-[9px] font-bold text-[#38bdf8] mb-1">
                                <span>{log.ver}</span><span>{log.date}</span>
                            </div>
                            <div className="text-[10px] font-mono text-gray-400 leading-relaxed border-l border-white/10 pl-3">
                                {log.event}
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        );

        // 2. KINETIC SYNC
        const KineticSync = ({ onComplete }) => {
            const [syncing, setSyncing] = useState(false);
            const [mode, setMode] = useState(0);
            const timer = useRef(null);
            const loops = ['radial-gradient(circle, #3B82F6 0%, transparent 70%)', 'radial-gradient(circle, #06b6d4 0%, transparent 70%)', 'radial-gradient(circle, #D4AF37 0%, transparent 70%)'];

            const start = () => { SoundEngine.init(); setSyncing(true); timer.current = setInterval(() => { setMode(m => (m + 1) % 3); SoundEngine.playStrobe(); }, 150); };
            const stop = () => { clearInterval(timer.current); if (syncing) { SoundEngine.playSuccess(); onComplete(); } setSyncing(false); };

            return (
                <div className="h-screen w-full flex flex-col items-center justify-center kinetic-viewport select-none cursor-pointer relative overflow-hidden" 
                     onMouseDown={start} onMouseUp={stop} onTouchStart={start} onTouchEnd={stop}>
                    {loops.map((bg, i) => (
                        <div key={i} className={`kinetic-loop ${syncing && mode === i ? 'kinetic-active' : ''}`} style={{ background: bg }}></div>
                    ))}
                    <div className="z-10 text-center animate-pulse">
                        <h2 className="text-[10px] font-mono tracking-[0.5em] text-white/40 mb-4 uppercase font-bold">Neural Calibration</h2>
                        <div className="text-4xl font-serif italic text-white mb-12 season-banner">Hold to Sync</div>
                        <div className={`w-24 h-24 rounded-full border-4 border-white/20 mx-auto flex items-center justify-center transition-all duration-300 ${syncing ? 'bg-white scale-110 shadow-[0_0_100px_white]' : 'bg-transparent'}`}>
                            <Icon name="fastforward" size={40} className={syncing ? 'text-black' : 'text-white'} />
                        </div>
                    </div>
                </div>
            );
        };

        // 3. LOGIN WALL
        const LoginWall = ({ onLogin }) => (
            <div className="h-screen w-full flex items-center justify-center relative overflow-hidden bg-black/95">
                <GenesisStream />
                <div className="relative z-10 w-full max-w-lg glass-panel p-20 rounded-[3rem] text-center space-y-12 shadow-[0_0_100px_rgba(56,189,248,0.1)] animate-in fade-in zoom-in duration-700">
                    <div className="w-24 h-24 mx-auto bg-white/5 rounded-full flex items-center justify-center border-[4px] border-[#D4AF37] bio-pulse shadow-[0_0_40px_rgba(212,175,55,0.3)]">
                        <Icon name="lock" size={48} className="text-[#D4AF37]" />
                    </div>
                    <div>
                        <h2 className="text-5xl font-serif font-black text-white tracking-widest uppercase mb-4">Neural Link</h2>
                        <p className="text-sm text-white/30 font-mono uppercase tracking-[0.5em]">Identity Protocol</p>
                    </div>
                    <button onClick={onLogin} className="w-full py-6 bg-white text-black font-black text-lg tracking-[0.4em] rounded-2xl uppercase hover:scale-105 transition-all shadow-2xl">
                        CONNECT IDENTITY
                    </button>
                    <div className="pt-6 border-t border-white/5 opacity-20">
                        <p className="text-[10px] font-mono uppercase tracking-[0.4em]">Iron Spine Secure</p>
                    </div>
                </div>
            </div>
        );

        // 4. ORACLE HUD
        const OracleHUD = ({ score, value, match, soul }) => (
            <div className="absolute top-[-160px] left-1/2 -translate-x-1/2 w-80 glass-panel border-[#38bdf8]/30 rounded-2xl p-4 shadow-[0_0_50px_rgba(56,189,248,0.2)] animate-fade-in z-50">
                <div className="flex justify-between items-center mb-3 border-b border-white/5 pb-2">
                    <span className="text-[10px] font-bold text-[#38bdf8] flex items-center gap-1"><Icon name="eye" size={12} /> THE ORACLE</span>
                    <span className="text-[9px] font-mono text-gray-500 uppercase font-bold tracking-widest">Analysis</span>
                </div>
                <div className="grid grid-cols-2 gap-2 mb-3">
                    <div className="bg-white/5 p-2 rounded text-center"><div className="text-[9px] text-gray-400">VIRALITY</div><div className="text-lg font-bold text-white font-mono">{score}/100</div></div>
                    <div className="bg-white/5 p-2 rounded text-center"><div className="text-[9px] text-gray-400">VALUATION</div><div className="text-lg font-bold text-green-400 font-mono">${value}</div></div>
                </div>
                <div className="flex justify-between items-center mb-3 px-1">
                    <span className="text-[9px] text-gray-400 flex items-center gap-1"><Icon name="heart" size={10} className="text-purple-400" /> SOUL:</span>
                    <span className="text-[9px] font-mono text-purple-300 font-bold tracking-tighter">{soul}</span>
                </div>
                <div className="bg-[#38bdf8]/10 border border-[#38bdf8]/20 p-2 rounded flex items-center gap-2"><Icon name="briefcase" size={12} className="text-[#38bdf8]" /><div><div className="text-[9px] font-bold text-gray-200 uppercase tracking-widest">Match: {match}</div></div></div>
            </div>
        );

        // 5. NEXUS HUD
        const NexusHUD = ({ isOpen, onClose, balance }) => {
            if (!isOpen) return null;
            return (
                <div className="w-80 h-full glass-hud flex flex-col font-sans animate-slide-left z-50 absolute right-0 top-0 bottom-0 border-l border-white/10">
                    <div className="h-14 border-b border-white/10 flex items-center justify-between px-4 bg-black/40"><div className="flex items-center gap-2"><Icon name="activity" size={14} className="text-[#38bdf8]" /><span className="text-xs font-bold text-white tracking-widest">NEXUS</span></div><button onClick={() => { SoundEngine.playClick(); onClose(); }} className="text-gray-500 hover:text-white">✕</button></div>
                    <div className="p-3 bg-gradient-to-r from-purple-900/20 to-blue-900/20 border-b border-white/5 flex justify-between items-center"><span className="text-[10px] font-bold text-purple-400">SEASON ENDS</span><span className="text-[10px] font-mono text-white">12D : 04H</span></div>
                    <div className="p-4 bg-white/5 border-b border-white/5"><div className="flex justify-between items-center mb-3"><span className="text-[10px] text-gray-400">NET WORTH</span><span className="text-sm font-bold text-white font-mono">{balance.toLocaleString()} FLUX</span></div><button className="w-full py-2 rounded flex items-center justify-center gap-2 text-[10px] font-bold bg-green-500/20 text-green-400 border border-green-500/30"><Icon name="server" size={12} className="animate-pulse" /> HIVE MINING: ACTIVE</button></div>
                    <div className="p-4 space-y-4"><div className="bg-[#0f111a] border border-veo-gold/20 rounded-lg p-3"><h4 className="text-[10px] font-bold text-white mb-2 flex gap-2"><Icon name="cpu" size={12} /> COMPUTE SWAP</h4><button className="w-full py-1.5 bg-veo-gold text-black text-[9px] font-bold rounded">TRADE EQUITY</button></div><div className="bg-white/5 border border-white/5 rounded-lg p-3"><div className="flex justify-between mb-1"><span className="text-[10px] text-gray-300 font-bold">Asset_01</span><span className="text-[9px] text-green-400">+450 CR</span></div><div className="text-[9px] text-gray-500">Viral (1.2M Views)</div></div></div>
                </div>
            );
        };

        const App = () => {
            const [view, setView] = useState('KINETIC');
            const [user, setUser] = useState(null);
            const [script, setScript] = useState("");
            const [oracle, setOracle] = useState(null);
            const [showNexus, setShowNexus] = useState(false);
            const [activeLens, setActiveLens] = useState('STD');
            const [xrayActive, setXrayActive] = useState(false);
            const [lightPos, setLightPos] = useState({ x: 50, y: 30 });
            const [showExchange, setShowExchange] = useState(false);
            const [bootLogs, setBootLogs] = useState([]);
            const [calibrationComplete, setCalibrationComplete] = useState(false);

            useEffect(() => {
                const check = setInterval(() => {
                    if (window.fbOnAuth) {
                        clearInterval(check);
                        window.fbOnAuth(window.auth, (u) => { 
                            if (u) {
                                setUser(u);
                                if (calibrationComplete) setView('INCUBATION');
                            }
                        });
                    }
                }, 100);
                return () => clearInterval(check);
            }, [calibrationComplete]);

            useEffect(() => {
                if (script.length > 10 && !oracle) {
                    let match = 'GENERIC'; let soul = 'NEUTRAL';
                    const lower = script.toLowerCase();
                    if (lower.includes('impossible') || lower.includes('stripe')) match = 'ADIDAS';
                    else if (lower.includes('do it') || lower.includes('swoosh')) match = 'NIKE';
                    if (lower.includes('love') || lower.includes('pain')) soul = 'HIGH_RESONANCE';
                    const score = Math.min(98, 40 + (script.length/2));
                    setOracle({ score, value: (score * 1.5).toFixed(0), match, soul });
                }
            }, [script]);

            const handleIgnite = () => {
                if (script.length < 5) return;
                SoundEngine.playIgnite();
                setView('IGNITION');
                const steps = ["Linking Neural Net...", "Harvesting IP...", "Routing...", "Rendering...", "ACCESS GRANTED."];
                let i = 0;
                const interval = setInterval(() => {
                    setBootLogs(p => [...p, steps[i]]); i++;
                    if (i >= steps.length) { clearInterval(interval); setTimeout(() => { setView('STUDIO'); setShowExchange(true); SoundEngine.playSuccess(); }, 800); }
                }, 600);
            };

            const handleLogin = () => {
                if (window.fbSignIn) {
                    window.fbSignIn(window.auth, window.googleProvider).then(r => { 
                        setUser(r.user); 
                        setView('INCUBATION'); 
                    }).catch(e => {
                        console.error("Login Failed:", e);
                        alert("Login Failed: " + e.message);
                    });
                }
            };

            return (
                <div className="w-full h-screen bg-black overflow-hidden relative">
                    <div className={`atmosphere ${view !== 'KINETIC' ? 'atmosphere-active' : ''}`}></div>

                    {view === 'KINETIC' && <KineticSync onComplete={() => { setCalibrationComplete(true); setView(user ? 'INCUBATION' : 'LOGIN'); }} />}

                    {view === 'LOGIN' && <LoginWall onLogin={handleLogin} />}

                    {view === 'INCUBATION' && (
                        <div className="flex-1 h-full flex flex-col items-center justify-center p-6 animate-fade-in relative z-10">
                            <div className="absolute top-6 right-6 flex items-center gap-3">
                                <div className="text-right">
                                    <div className="text-[10px] font-bold text-white uppercase tracking-widest">{user?.displayName || "UNLINKED"}</div>
                                    <div className="text-[9px] text-[#38bdf8] font-mono uppercase">Tier: Free</div>
                                </div>
                                <div className="w-8 h-8 rounded-full bg-gray-800 border border-white/20 flex items-center justify-center text-xs overflow-hidden cursor-pointer" onClick={() => { if(window.fbSignOut) { window.fbSignOut(window.auth); setView('LOGIN'); } }}>
                                    {user?.photoURL ? <img src={user.photoURL} className="w-full h-full" /> : "U"}
                                </div>
                            </div>
                            <div className="relative z-10 w-full max-w-2xl group">
                                {oracle && <OracleHUD {...oracle} />}
                                <h1 className="text-5xl md:text-7xl font-serif text-center mb-8 tracking-tighter text-white">Direct Your <span className="italic season-banner">Dreams.</span></h1>
                                <div className="relative bg-white/5 backdrop-blur-md border border-white/10 rounded-2xl overflow-hidden shadow-2xl transition-all duration-500 group-focus-within:border-white/30">
                                    <textarea value={script} onChange={(e) => setScript(e.target.value)} placeholder="Describe your vision..." className="w-full h-48 bg-transparent p-8 text-xl font-serif text-white placeholder-gray-700 resize-none focus:outline-none leading-relaxed" autoFocus spellCheck="false" />
                                    <div className="oracle-scanner pointer-events-none"></div>
                                </div>
                                <div className="mt-8 flex justify-center">
                                    <button onClick={() => setView('STUDIO')} disabled={script.length < 5} className={`btn-ignite text-black px-12 py-5 rounded-full font-bold text-xs tracking-[0.2em] flex items-center gap-3 ${script.length < 5 ? 'opacity-0 translate-y-4' : 'opacity-100 translate-y-0'}`}>
                                        <Icon name="zap" size={16} /> IGNITE ENGINE
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {view === 'IGNITION' && (
                        <div className="w-full flex-1 absolute inset-0 bg-black z-50 flex flex-col items-center justify-center font-mono">
                            <div className="w-80 space-y-2 h-32 overflow-hidden border-l border-white/10 pl-4">{bootLogs.map((log, i) => (<div key={i} className="text-[10px] text-[#38bdf8] animate-slide-up">> {log}</div>))}</div>
                        </div>
                    )}

                    {view === 'STUDIO' && (
                        <div className="flex-1 h-full flex flex-col relative animate-fade-in z-10">
                            {showExchange && (
                                <div className="absolute top-20 right-6 z-[100] bg-[#111] border border-white/10 rounded-xl p-3 w-72 shadow-2xl animate-slide-left">
                                    <div className="flex justify-between items-center mb-2"><span className="text-[10px] font-bold text-white flex items-center gap-2"><Icon name="network" size={12} className="text-[#3B82F6]" /> B2B ROUTING</span><button onClick={() => setShowExchange(false)} className="text-gray-500">✕</button></div>
                                    <div className="text-[10px] text-gray-400 bg-white/5 p-2 rounded mb-2">Asset routed to <span className="text-white font-bold">OpenAI_Training_Node</span>.</div>
                                    <div className="text-[9px] font-mono text-veo-green font-bold text-center">+150 FLUX (70% SPLIT)</div>
                                </div>
                            )}
                            <div className="h-14 border-b border-white/10 flex justify-between items-center px-6 bg-black/40 z-10">
                                <div className="text-[10px] font-mono text-gray-500 uppercase tracking-widest font-bold">GENESIS_01</div>
                                <div className="flex gap-2">
                                    {['STD', 'NOIR', 'NEON'].map(l => (<button key={l} onClick={() => { setActiveLens(l); SoundEngine.playClick(); }} className={`px-4 py-1 rounded border text-[10px] font-black ${activeLens === l ? 'lens-active' : 'border-white/10 text-gray-500'}`}>{l}</button>))}
                                </div>
                                <button onClick={() => { setXrayActive(!xrayActive); SoundEngine.playXray(); }} className={`flex items-center gap-2 px-6 py-2 rounded-full text-xs font-black border transition-all ${xrayActive ? 'bg-green-500/20 border-green-500 text-green-400 animate-pulse' : 'bg-white/5 border-white/10 text-gray-400 hover:text-white'}`}><Icon name="grid" size={12} /> X-RAY</button>
                                <button onClick={() => setShowNexus(!showNexus)} className="bg-[#38bdf8]/10 text-[#38bdf8] px-6 py-2 rounded-full text-xs font-black flex items-center gap-2 border border-[#38bdf8]/30 hover:bg-[#38bdf8]/20 transition-all uppercase tracking-widest"><Icon name="activity" size={12} /> NEXUS HUD</button>
                            </div>
                            <div className="flex-1 flex items-center justify-center bg-black relative overflow-hidden" onMouseMove={(e) => { if (e.buttons === 1) { const rect = e.currentTarget.getBoundingClientRect(); setLightPos({ x: (e.clientX - rect.left)/rect.width*100, y: (e.clientY - rect.top)/rect.height*100 }); } }}>
                                <div className={`absolute inset-0 z-0 flex items-center justify-center overflow-hidden pointer-events-none ${xrayActive ? 'xray-visible' : 'opacity-0'}`}><div className="w-[200%] h-[200%] xray-grid"></div></div>
                                <div className={`relative w-full max-w-4xl aspect-video bg-gray-900 rounded-lg border border-[#D4AF37]/20 shadow-2xl overflow-hidden group ${activeLens === 'NOIR' ? 'filter-noir' : activeLens === 'NEON' ? 'filter-neon' : ''} ${xrayActive ? 'xray-active' : ''}`}>
                                    <div className="absolute inset-0 bg-cover bg-center" style={{ backgroundImage: 'url("https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?q=80&w=1200")' }}></div>
                                    <div className="absolute inset-0 pointer-events-none mix-blend-overlay" style={{ background: `radial-gradient(circle at ${lightPos.x}% ${lightPos.y}%, rgba(255,255,255,0.4) 0%, transparent 60%)` }}></div>
                                    {!xrayActive && <div className="light-orb" style={{ left: `${lightPos.x}%`, top: `${lightPos.y}%` }}></div>}
                                    <div className="absolute bottom-4 right-4 text-white/30 font-black text-2xl font-sans tracking-tighter select-none pointer-events-none mix-blend-overlay uppercase">CineGenesis</div>
                                </div>
                            </div>
                            <div className="h-32 border-t border-white/5 bg-black/40 p-4 flex flex-col gap-2 relative z-10">
                                <div className="flex justify-between items-center text-[10px] font-mono text-gray-500 uppercase tracking-widest"><span>SEQUENCING</span><span>0 CREDITS</span></div>
                                <div className="flex-1 flex gap-2 overflow-x-auto pb-1 no-scrollbar">
                                    <div className="w-48 h-full rounded bg-white/5 border border-white/10 relative"><div className="absolute top-2 left-2 text-[9px] font-bold text-white uppercase tracking-widest font-bold">Scene 01</div></div>
                                    <div className="w-48 h-full rounded border border-[#38bdf8] bg-black/20 relative flex items-center justify-center cursor-pointer opacity-70 hover:opacity-100 transition-opacity" onClick={() => SoundEngine.playClick()}><div className="flex flex-col items-center gap-1"><Icon name="lock" size={14} className="text-[#38bdf8]" /><span className="text-[8px] text-[#38bdf8] font-bold uppercase tracking-widest">Unlock Scene 02</span></div></div>
                                </div>
                            </div>
                        </div>
                    )}
                    <NexusHUD isOpen={showNexus} onClose={() => setShowNexus(false)} balance={14670} />
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<CineGenesisApp />);
    </script>
</body>
</html>
